---
layout: post
title: Using Dialogs in Mono for Android
date: '2013-02-23T15:48:00.000+01:00'
author: Tomasz Cielecki
tags:
- Patterns
- Mono for Android
- User Experience
- Android
modified_time: '2013-02-27T23:22:23.711+01:00'
thumbnail: http://2.bp.blogspot.com/-3B3vA9bzufU/USg2NBO_k2I/AAAAAAAAB9U/plKXd-CQ2qk/s72-c/1.PNG
blogger_id: tag:blogger.com,1999:blog-3433282516380174051.post-7391693812170834694
blogger_orig_url: http://blog.ostebaronen.dk/2013/02/using-dialogs-in-mono-for-android.html
---

Using Dialogs in Mono for Android is very similar to what you do when writing Java code for Android. But maybe let us first briefly look into what we can use Dialogs for. There are&nbsp;several&nbsp;things they are really useful for:<br /><div style="text-align: right;"></div><ul><li>Showing Alerts - The user gets notified about something important happening in the application, or the application failed. You might know the Alert Dialog, which shows when an application becomes unresponsive and you get the choice to either Wait or Force Close the application.</li><li>Selecting a values from lists - The user chooses a field and gets presented with a short list of choices. This could be for instance that you are already showing another dialog, where you want the user to write his username and password, but additionally you want the user to choose a server from a list of the available ones, this could get presented in a new dialog.</li><li>Adjusting settings - For instance when you have to adjust the brightness of your screen on your phone, you are shown a dialog with sliders for adjusting the brightness. This is also the case for volume etc.</li><li>Picking a Date or Time - This is used widely in Alarm clock and calendar applications.</li></ul><div>There are probably many more uses, but I think you get the idea about the use of Dialogs and what they are good for. If you notice the pattern, Dialogs are made for making the user take an action. What are Dialogs less good for? I highly recommend not using them for progress indications. Taking away the focus from the app to show a Dialog with a Progress Indicator is not good use, you should rather, if possible, show a ProgressBar or Activity Indicator in your view, and let your user navigate around your application, to be able to do something else in your application while they wait for the other task to end. This could be uploading a file to a server, people do not want to wait and watch a ProgressBar in a Dialog and not being able to do anything else, they will get bored quickly.</div><div><br /></div><div>Before we get our hands dirty in code let me explain the two methods to create Dialogs. One is you create it inline of the code where you need to show it. That could be in an EventHandler for a Button. Another way is to use the OnCreateDialog methods in an Activity, however note that these were Deprecated in API level 8 and 13 when Fragments were introduced. The instantiation of a Dialog has not changed. It is recommended to use a DialogFragment in API level 13 and above which I will cover at a later point in this blog post.<br /><br /><h3>Dialogs in Activities</h3></div><div><b><a href="https://github.com/Cheesebaron/MonoDroid.DialogSample" target="_blank">Get the sample code here!</a></b><br /><br />Now that is covered why don't we get our hands a bit dirty with some code samples? The first couple of samples are going to show what the default Dialog classes can show without using custom views inside, then some more advanced stuff will be shown. Also the first samples will use the old style of creating Dialogs inside activities, and the last samples will show the DialogFragment introduced in API level 13.<br /><br /></div><div>This first sample shows how to create a simple Yes/No type of dialog, which shows when a user presses a button. I use an AlertDialog.Builder to create this dialog, and you will see this approach used throughout the samples. An AlertDialog has loads of properties which can be set, such as the title, messsage, negative button and positive button. Here a message is set, the negative and positive buttons. The EventHandlers are empty in this sample, but could be used to do an action in your application. When using AlertDialog.Builder you need to call Create() at the end to get the actual AlertDialog instance, which then can be shown by calling Show(). <script class="brush: csharp;" title="Yes/No Dialog" type="syntaxhighlighter"><![CDATA[ var yesNoDialogbutton = FindViewById<button>(Resource.Id.YesNoDialogButton); yesNoDialogbutton.Click += delegate {  var builder = new AlertDialog.Builder(this);  builder.SetMessage(Resource.String.knigts_dialog_title);  builder.SetPositiveButton(Resource.String.yes, (s, e) => { });  builder.SetNegativeButton(Resource.String.no, (s, e) => { });  builder.Create().Show(); }; ]]></script>The resulting dialog can be seen in Figure 1. <br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://2.bp.blogspot.com/-3B3vA9bzufU/USg2NBO_k2I/AAAAAAAAB9U/plKXd-CQ2qk/s1600/1.PNG" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="126" src="http://2.bp.blogspot.com/-3B3vA9bzufU/USg2NBO_k2I/AAAAAAAAB9U/plKXd-CQ2qk/s320/1.PNG" width="320" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">Figure 1 - Simple Yes / No Dialog</td></tr></tbody></table><br /></div><div>Now lets look at how to create an Alert type of Dialog, screenshot can be seen in Figure 2, with an icon and title and a couple of buttons. Notice how this time I am calling ShowDialog inside the Click Event and how I have consts defined in the top of my class. This is due to the int id which is passed in ShowDialog is the same id which is passed as argument in OnCreateDialog where I create my dialogs, which is the pattern used pre API level 13. <br /><script class="brush: csharp;" title="Alert Dialog" type="syntaxhighlighter"><![CDATA[ public class DialogActivity : Activity {     private const int AlertDialog = 1;      protected override void OnCreate(Bundle bundle)     {         ...         var alertDialogButton = FindViewById<button>(Resource.Id.AlertDialogButton);         alertDialogButton.Click += delegate { ShowDialog(AlertDialog); };         ...     }      protected override Dialog OnCreateDialog(int id, Bundle args)     {      switch(id)      {       case AlertDialog:       {        var builder = new AlertDialog.Builder(this);        builder.SetIconAttribute(Android.Resource.Attribute.AlertDialogIcon);        builder.SetTitle(Resource.String.bomb_dialog_title);             builder.SetPositiveButton(Resource.String.dialog_signal, (s, e) => { /*Do something here!*/ });            builder.SetNegativeButton(Resource.String.dialog_main_screen, (s, e) => { });         return builder.Create();       }             ...      }        return base.OnCreateDialog(id, args);     } } ]]></script>This kind of Alert Dialog can of course also have some description text which is simply set with the SetMessage() method.<br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://2.bp.blogspot.com/-2DT90ovTP3I/USid30MIwrI/AAAAAAAAB9k/7eS_zjurT2k/s1600/2.PNG" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="130" src="http://2.bp.blogspot.com/-2DT90ovTP3I/USid30MIwrI/AAAAAAAAB9k/7eS_zjurT2k/s320/2.PNG" width="320" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">Figure 2 - Alert Dialog</td></tr></tbody></table></div><div>Now let us try something more exciting. Let us make a dialog with an item you can select from a list. <script class="brush: csharp;" title="List Dialog" type="syntaxhighlighter"><![CDATA[ public class DialogActivity : Activity {   ...  private const int ListDialog = 2;  ...      protected override void OnCreate(Bundle bundle)     {         ...         var listDialogButton = FindViewById<button>(Resource.Id.ListDialogButton);         listDialogButton.Click += delegate { ShowDialog(ListDialog); };         ...     }      protected override Dialog OnCreateDialog(int id, Bundle args)     {      switch(id)      {       ...    case ListDialog:    {     var builder = new AlertDialog.Builder(this);     builder.SetIconAttribute(Android.Resource.Attribute.AlertDialogIcon);     builder.SetTitle(Resource.String.list_dialog_title);     builder.SetSingleChoiceItems(Resource.Array.list_dialog_items, 0, ListClicked);      builder.SetPositiveButton(Resource.String.dialog_ok, OkClicked);     builder.SetNegativeButton(Resource.String.dialog_cancel, CancelClicked);      return builder.Create();    }             ...      }        return base.OnCreateDialog(id, args);     }    private void ListClicked(object sender, DialogClickEventArgs args)  {   var items = Resources.GetStringArray(Resource.Array.list_dialog_items);   Toast.MakeText(this, string.Format("You've selected: {0}, {1}", args.Which, items[args.Which]), ToastLength.Short).Show();  } }]]></script><br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://4.bp.blogspot.com/-U1IYVjWoreg/USjDgl3FmbI/AAAAAAAAB90/5OVamjY6gIY/s1600/3.PNG" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="400" src="http://4.bp.blogspot.com/-U1IYVjWoreg/USjDgl3FmbI/AAAAAAAAB90/5OVamjY6gIY/s400/3.PNG" width="284" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">Figure 3 - List Dialog</td></tr></tbody></table>The AlertDialog class has a nice method SetSingleChoiceItems which takes a list of items either from Arrays.xml or a an array of items. You also need to provide it with an EventHandler for what happens when an Item in the list is selected. Otherwise it is the same approach as the other two Dialogs shown. Instead of using lambda expressions for the Event Handlers for the positive and negative buttons you can also make methods for handling the events. The result of this dialog can be seen in Figure 3. </div><div><br />AlertDialog also has a nice method for making Multiple Choice Dialogs, so it shows a list of items which have checkboxes. This is done by giving the method SetMultiChoiceItems an array of items either from Resource or an instance, you can choose which items are checked or not and lastly add an Event Handler for handling which items are chosen. <script class="brush: csharp;" title="Multiple Choice Dialog" type="syntaxhighlighter"><![CDATA[ public class DialogActivity : Activity {   ...  private const int MultiChoiceDialog = 3;  ...      protected override void OnCreate(Bundle bundle)     {         ...   var multiChoiceDialogButton = FindViewById<button>(Resource.Id.MultiChoiceDialogButton);   multiChoiceDialogButton.Click += delegate { ShowDialog(MultiChoiceDialog); };         ...     }      protected override Dialog OnCreateDialog(int id, Bundle args)     {      switch(id)      {       ...    case MultiChoiceDialog:    {     var builder = new AlertDialog.Builder(this, Android.App.AlertDialog.ThemeHoloLight);     builder.SetIcon(Resource.Drawable.Icon);     builder.SetTitle(Resource.String.multi_choice_dialog_title);     builder.SetMultiChoiceItems(Resource.Array.multilist_dialog_items,       new[] { false, true, false, true }, MultiListClicked);      builder.SetPositiveButton(Resource.String.dialog_ok, OkClicked);     builder.SetNegativeButton(Resource.String.multi_dialog_cancel, CancelClicked);      return builder.Create();    }             ...      }        return base.OnCreateDialog(id, args);     }    private void MultiListClicked(object sender, DialogMultiChoiceClickEventArgs args)  {   var items = Resources.GetStringArray(Resource.Array.multilist_dialog_items);    Toast.MakeText(this, string.Format("{0} is checked {1}", items[args.Which], args.IsChecked), ToastLength.Short).Show();  } } ]]></script><br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://3.bp.blogspot.com/-KRzg1J46oKY/USjJ3Ic-W2I/AAAAAAAAB-E/eYMYwZscvps/s1600/4.PNG" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="320" src="http://3.bp.blogspot.com/-KRzg1J46oKY/USjJ3Ic-W2I/AAAAAAAAB-E/eYMYwZscvps/s320/4.PNG" width="290" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">Figure 4 - Multi Choice List Dialog</td></tr></tbody></table>You might also have noticed that I've passed a second argument to the AlertDialog.Builder, which actually allows you to set the theme of the Dialog, in this case it sets the theme to Holo Light, which can be seen in Figure 4, this can be done when using API level 13 and above. But again, very simple stuff! </div><div><br />Final example shows how to make a Dialog with a custom view inside of it. Approach is exactly the same as with the other examples, however this time I use the SetView() method of AlertDialog to set the custom view, which I have inflated. The OnClicked handler also shows you how to get the data from the elements in custom view. <script class="brush: csharp;" title="Custom View Dialog" type="syntaxhighlighter"><![CDATA[ var customView = LayoutInflater.Inflate (Resource.Layout.CustomDialog, null);  var builder = new AlertDialog.Builder(this); builder.SetView(customView); builder.SetPositiveButton(Resource.String.dialog_ok, OkClicked); builder.SetNegativeButton(Resource.String.dialog_cancel, CancelClicked);  return builder.Create(); ]]></script><script class="brush: xml;" title="Custom View" type="syntaxhighlighter"><![CDATA[ <?xml version="1.0" encoding="utf-8"?><linearlayout xmlns:android="http://schemas.android.com/apk/res/android"     android:orientation="vertical"     android:layout_width="wrap_content"     android:layout_height="wrap_content">    <RelativeLayout         android:layout_width="wrap_content"         android:layout_height="64dp">        <View             android:layout_width="match_parent"             android:layout_height="match_parent"             android:background="#FFFFBB33" />        <TextView             android:layout_width="match_parent"             android:layout_height="match_parent"             android:typeface="monospace"             android:textSize="30dp"             android:text="Awesome!"             android:textColor="#FFFFFFFF"             android:gravity="center" />    </RelativeLayout>    <EditText         android:id="@+id/username"         android:inputType="textEmailAddress"         android:layout_width="match_parent"         android:layout_height="wrap_content"         android:layout_marginTop="16dp"         android:layout_marginLeft="4dp"         android:layout_marginRight="4dp"         android:layout_marginBottom="4dp"         android:hint="Username" />    <EditText         android:id="@+id/password"         android:inputType="textPassword"         android:layout_width="match_parent"         android:layout_height="wrap_content"         android:layout_marginTop="4dp"         android:layout_marginLeft="4dp"         android:layout_marginRight="4dp"         android:layout_marginBottom="16dp"         android:hint="Password" /></LinearLayout>]]></script><script class="brush: csharp;" title="OkClicked EventHandler" type="syntaxhighlighter"><![CDATA[ private void OkClicked(object sender, DialogClickEventArgs args) {  var dialog = (AlertDialog) sender;  var username = (EditText)dialog.FindViewById(Resource.Id.username);  var password = (EditText)dialog.FindViewById(Resource.Id.password);   if (null != username || null != password)   Toast.MakeText(this, (username != null ?     string.Format("Username: {0} ", username.Text) : "") +     (password != null ? string.Format("Password: {0}", password.Text) : ""), ToastLength.Short).Show(); } ]]></script><br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://4.bp.blogspot.com/-NDqAjAg5Ct8/USjOgkPmwrI/AAAAAAAAB-U/qS3jkWcc1IQ/s1600/5.PNG" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="257" src="http://4.bp.blogspot.com/-NDqAjAg5Ct8/USjOgkPmwrI/AAAAAAAAB-U/qS3jkWcc1IQ/s320/5.PNG" width="320" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">Figure 5 - Custom View Dialog</td></tr></tbody></table>So what happens in the OkClicked Event Handler, is that it conveniently receives the AlertDialog in the sender object, which we can use to find all the views contained in it. This allows us to simply use FindViewById to find the two EditText's contained in the custom view which were set. <br /><br /><h3>Dialogs in Fragments</h3>You might think that this is all to know about Dialogs, but sorry there are still some stuff to cover. I've pointed out that some methods were deprecated in API level 8 and 13, and a new pattern was introduced around that time called Fragments. Creating Dialogs in Fragments is slightly different that in Activities; hence I will show you two examples on how that is done. However creating the actual Dialog is still done with AlertDialog, but I will also show you one of the built in Dialogs in Android. <br />Lets just dive into the code! <script class="brush: csharp;" title="CoolDialogsFragment" type="syntaxhighlighter"><![CDATA[ public class CoolDialogsFragment : Fragment, DatePickerDialog.IOnDateSetListener, NumberPicker.IOnValueChangeListener {  public override View OnCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState)  {   var view = inflater.Inflate(Resource.Layout.DialogFragment_Contents, container, false);    var datePickerButton = view.FindViewById<button>(Resource.Id.DatePickerDialogButton);   datePickerButton.Click += delegate   {    var dialog = new DatePickerDialogFragment(Activity, DateTime.Now, this);    dialog.Show(FragmentManager, "date");    };    var numberPickerButton = view.FindViewById<button>(Resource.Id.NumberPickerDialogButton);   numberPickerButton.Click += delegate   {    var dialog = new NumberPickerDialogFragment(Activity, 10, 1337, 42, this);    dialog.Show(FragmentManager, "number");    };    return view;  }   public void OnDateSet(DatePicker view, int year, int monthOfYear, int dayOfMonth)  {   Toast.MakeText(Activity, string.Format("Picked date: {0}/{1}/{2}", year, monthOfYear + 1, dayOfMonth), ToastLength.Short).Show();  }   public void OnValueChange(NumberPicker picker, int oldVal, int newVal)  {   Toast.MakeText(Activity, string.Format("Value changed from: {0} to {1}", oldVal, newVal), ToastLength.Short).Show();  } } ]]></script><br />This is a very simple dialog inflating a view with a couple of buttons. Their Click events are set to instantiate a some dialogs, which are not shown. But this approach is the way you show Dialogs when using Fragments. Actually you are displaying DialogFragments. It also implements a couple of listeners for the two different Dialogs which I will show you now. <br /><script class="brush: csharp;" title="DatePickerDialogFragment" type="syntaxhighlighter"><![CDATA[ private class DatePickerDialogFragment : DialogFragment {  private readonly Context _context;  private DateTime _date;  private readonly DatePickerDialog.IOnDateSetListener _listener;   public DatePickerDialogFragment(Context context, DateTime date, DatePickerDialog.IOnDateSetListener listener)  {   _context = context;   _date = date;   _listener = listener;  }   public override Dialog OnCreateDialog(Bundle savedState)  {   var dialog = new DatePickerDialog(_context, _listener, _date.Year, _date.Month - 1, _date.Day);   return dialog;  } } ]]></script> <br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://1.bp.blogspot.com/-6ywFWgJf6QM/USjT7vs9T_I/AAAAAAAAB-k/xGlA8IMk_Uc/s1600/6.PNG" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="320" src="http://1.bp.blogspot.com/-6ywFWgJf6QM/USjT7vs9T_I/AAAAAAAAB-k/xGlA8IMk_Uc/s320/6.PNG" width="313" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">Figure 6 - DatePickerDialogFragment</td></tr></tbody></table>For the DatePickerDialogFragment, we are lucky that Android actually have a DatePickerDialog implemented already which just needs to be wired up to a listener and set a date inside of it. The listener allows us to listen for date changes in the Dialog. Using a DialogFragment requires you to create a Dialog inside of OnCreateDialog. That is it, here you can create all the Dialogs I have shown you in the previous samples with the AlertDialog.Builder, you just have to create these DialogFragments, instead of putting them into Activities OnCreateDialog(). The DatePickerDialogFragment can be seen in Figure 6. </div><div><br />Just to show another example, let us create a Custom View DialogFragment, which allows you to pick a number from a NumberPicker, see Figure 7. <script class="brush: csharp;" title="NumberPickerDialogFragment" type="syntaxhighlighter"><![CDATA[ private class NumberPickerDialogFragment : DialogFragment {  private readonly Context _context;  private readonly int _min, _max, _current;  private readonly NumberPicker.IOnValueChangeListener _listener;   public NumberPickerDialogFragment(Context context, int min, int max, int current, NumberPicker.IOnValueChangeListener listener)  {   _context = context;   _min = min;   _max = max;   _current = current;   _listener = listener;  }   public override Dialog OnCreateDialog(Bundle savedState)  {   var inflater = (LayoutInflater)_context.GetSystemService(Context.LayoutInflaterService);   var view = inflater.Inflate(Resource.Layout.NumberPickerDialog, null);   var numberPicker = view.FindViewById<numberpicker>(Resource.Id.numberPicker);   numberPicker.MaxValue = _max;   numberPicker.MinValue = _min;   numberPicker.Value = _current;   numberPicker.SetOnValueChangedListener(_listener);    var dialog = new AlertDialog.Builder(_context);   dialog.SetTitle(Resource.String.number_dialog_title);   dialog.SetView(view);   dialog.SetNegativeButton(Resource.String.dialog_cancel, (s, a) => { });   dialog.SetPositiveButton(Resource.String.dialog_ok, (s, a) => { });   return dialog.Create();  } } ]]></script><br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://3.bp.blogspot.com/-6DOnjRTDEbk/USjUjcaPZ7I/AAAAAAAAB-s/Ef1-3A015AE/s1600/7.PNG" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="320" src="http://3.bp.blogspot.com/-6DOnjRTDEbk/USjUjcaPZ7I/AAAAAAAAB-s/Ef1-3A015AE/s320/7.PNG" width="313" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">Figure 7 - NumberPickerDialogFragment</td></tr></tbody></table><br />Now you have seen a lot of different Dialogs, both using the old deprecated Activity approach and the newer Fragment approach. The entire sample can be seen in my <a href="https://github.com/Cheesebaron/MonoDroid.DialogSample">GitHub repository for this blog post</a>. </div>