---
layout: post
title: Using RESX files in PCL for Xamarin and Windows projects
date: '2016-03-11T16:29:00.000+01:00'
author: Tomasz Cielecki
tags:
- Localization
- Xamarin
modified_time: '2016-03-11T16:29:30.522+01:00'
thumbnail: https://2.bp.blogspot.com/-ro1GontfM4I/VuLfK6jOZhI/AAAAAAAADdk/yr53nyM0EJ4PVUuO8Kspyf233XcLxlyQg/s72-c/Capture.PNG
blogger_id: tag:blogger.com,1999:blog-3433282516380174051.post-5140640319524287186
blogger_orig_url: http://blog.ostebaronen.dk/2016/03/using-resx-files-in-pcl-for-xamarin-and.html
---

I've been working on a project which is targeted for Xamarin.Android, Xamarin.iOS and Windows 8.1 (non-Silverlight). They are all sharing the same PCL projects for ViewModels, Services etc. Hence, I thought this was an ideal place to chuck in application strings. Don't get me wrong, it still is! However, there are some things you need to know in order to get it to work nicely with the Windows 8.1 project.<br /><br />Windows 8 introduced new RES<b>W</b>&nbsp;files, which structurally are similar to RESX files. However, instead of needing to have all sorts of helpers etc. to bind localized text strings and now dimensions etc. to properties of FrameworkElements, that is now done by convention. Which is really neat. However, this is of course only for Windows 8.<br />How this looks in practice is that your key for some resource could be something like: <i>Welcome.Text</i>&nbsp;and the value could be something like <i>Hello, World!</i><br />In your XAML file you could then have something like <i>&lt;TextBlock x:Uid="Welcome" Text="Design Time Text" /&gt;</i>&nbsp;and then the <i>Text</i>&nbsp;property would automatically be set to the one in the<i>&nbsp;</i>RESW file. Neat!<br /><br />Now all this RESW stuff is cool and all. However, if you are either too lazy to migrate to RESW or if you want to use RESX files because they work nicely with Xamarin projects then it is not all that nice in the Windows 8 world.<br /><br />In Debug using the RESX approach, it switched automagically to the correct language. However, as many other posts around the Internet described, this was not the case on a device when having created a Store package. It would always default to the neutral or default language.<br /><br />Several <a href="http://blogs.msdn.com/b/philliphoff/archive/2014/11/19/missingmanifestresourceexception-when-using-portable-class-libraries-in-winrt.aspx" target="_blank">sources say this blog post</a> is the solution to the problem in my case nothing actually happened. It describes how to use your own implementation of <i>ResourceManager</i>&nbsp;and having a break-point in the <i>GetString</i>&nbsp;method I saw the <i>CultureInfo</i>&nbsp;always was null. However, the Default one was actually correct. Nevertheless the incorrect language was taken from my RESX files when deploying a Store package.<br /><br />After having spent way too much time on figuring this issue out I fell over <a href="https://www.suchan.cz/2013/09/shared-localization-for-windows-phone-8-and-windows-8-apps-using-pcl/" target="_blank">this blog post</a>, which points out a key to still be able to use RESX files in a Windows 8.1 project and Xamarin projects at the same time with it being shared in a PCL.<br /><br />The steps are quite simple.<br /><br /><br /><ol><li>In the PCL where you have your RESX file(s) add the following to the csproj file:&nbsp;<i>&lt;SupportedCultures&gt;&lt;/SupportedCultures&gt;</i>&nbsp;this should simply contain the language codes semi-colon separated like so:&nbsp;<i>&lt;SupportedCultures&gt;en;da;de&lt;/SupportedCultures&gt;</i></li><li>In your Windows 8.1 project. Create a <i>strings</i> folder with each of the supported language codes as subfolders.</li><li>Create a RESW file in each of those language code subfolders.</li></ol><div>The result should look something like</div><div class="separator" style="clear: both; text-align: left;"><a href="https://2.bp.blogspot.com/-ro1GontfM4I/VuLfK6jOZhI/AAAAAAAADdk/yr53nyM0EJ4PVUuO8Kspyf233XcLxlyQg/s1600/Capture.PNG" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="https://2.bp.blogspot.com/-ro1GontfM4I/VuLfK6jOZhI/AAAAAAAADdk/yr53nyM0EJ4PVUuO8Kspyf233XcLxlyQg/s1600/Capture.PNG" /></a></div><div><br /></div><div>That is it. Now your Windows 8.1 project should be able to pick up all the languages you have specified and you can get the correct strings from your RESX files.</div><div><br /></div><div><br /></div><div><br /></div><div>Here is how I use it.</div><div><br /></div><div>In my PCL I have a small helper for Windows 8.1 which looks like:</div><div><br /><script src="https://gist.github.com/Cheesebaron/a68316d05c4e01f355a2.js?file=LocalizedStrings.cs"></script> I have registered that helper in my <i>App.xaml</i>&nbsp;file like so:<br /><br /><script src="https://gist.github.com/Cheesebaron/a68316d05c4e01f355a2.js?file=App.xaml"></script> Then I can use it like this in my Windows 8.1 app XAML pages and templates:<br /><br /><script src="https://gist.github.com/Cheesebaron/a68316d05c4e01f355a2.js?file=Whatever.xaml"></script><br />Given that <i>Welcome</i>&nbsp;is a key in the RESX files.<br /><br /><br />On iOS I create my views in C# code pretty much by hand. Hence I simply use the RESX files directly. So if we say my RESX file is called <i>ApplicationStrings.resx</i>&nbsp;then usage looks like:<br /><br /><script src="https://gist.github.com/Cheesebaron/a68316d05c4e01f355a2.js?file=Ios.cs"></script><br /><br />On Android I use <a href="https://github.com/MvvmCross/MvvmCross-Plugins/tree/master/ResxLocalization" target="_blank">RESX localization plugin for MvvmCross</a>, <a href="http://opendix.blogspot.ch/2013/05/using-resx-files-for-localization-in.html" target="_blank">where Stefan Schoeb has a very nice description</a> on how to use it. I don't use it for iOS since it is just easier to directly get the strings. Less code&nbsp;üòÅ</div>